import{A as e,C as t,E as n,F as r,M as i,N as a,O as o,S as s,T as c,_ as l,c as u,d,f,g as p,h as m,i as h,j as g,k as _,m as v,p as y,u as b,v as x,w as S,x as C,y as w}from"./index-BdTzLahI.js";import{d as T,g as E,h as D,m as O,n as k,o as A,t as j}from"./classes-B4NYo6ki.js";const M=()=>k.map(e=>{let t=A.filter(t=>t.classId===e.id).map(e=>{let t=T.filter(t=>t.studentId===e.id);return{...e,scores:t}});return{...e,students:t}}),N=(e=1,t=10,n,r)=>{let i=M();n&&(i=i.filter(e=>n===`é«˜ä¸€`?e.name.includes(`é«˜ä¸€`):n===`é«˜äºŒ`?e.name.includes(`é«˜äºŒ`):n===`é«˜ä¸‰`?e.name.includes(`é«˜ä¸‰`):!0)),r&&(i=i.filter(e=>e.name===r));let a=(e-1)*t,o=a+t;return{data:i.slice(a,o),total:i.length,page:e,size:t}},P=new class{async getNestedClasses(e){await D(500);try{let{data:t,total:n}=N(e?.page||1,e?.size||10,e?.grade,e?.className);return O(t,`success`,200,{page:e?.page||1,size:e?.size||10,total:n})}catch{return E(`è·å–æ•°æ®å¤±è´¥`,500)}}async getClassDetails(e){await D(300);let t=N().data.find(t=>t.id===e);return t?O(t):E(`ç­çº§ä¸å­˜åœ¨`,404)}};var F={class:`table-merge-demo`},ee={class:`control-panel-area`},te={class:`control-panel`},ne={class:`control-filters`},re={class:`filter-item`},I={class:`filter-item`},L={class:`filter-item`},R={key:0,class:`stats-info`},z={class:`data-display-area`},B={class:`table-wrapper`},V={key:0},H={key:1},U={class:`action-buttons`},W={class:`pagination-wrapper`},G=h(C({__name:`TableMergeDemo`,setup(h){let C=g(!1),T=g(1),E=g(5),D=g(``),O=g(``),k=g([]),A=g([]),M=g({page:1,size:1,total:0}),N=f(()=>Math.ceil(M.value.total/E.value)),G=f(()=>A.value.reduce((e,t)=>e+t.students.length,0)),K=f(()=>A.value.reduce((e,t)=>e+t.students.reduce((e,t)=>e+(t.scores?.length||0),0),0)),q=f(()=>{let e=[];return A.value.forEach(t=>{let n=t.id,r=t.name,i={classId:n,className:r,grade:J(r)};t.students.length===0?e.push({...i,uniqueId:`class_${n}_empty`,studentId:`--`,studentName:`æš‚æ— å­¦ç”Ÿ`,gender:`--`,age:`--`,scoreId:`--`,examDate:`--`,score:`--`,_meta:{classId:n,studentId:null,isFirstStudent:!0,studentCount:0,hasScores:!1}}):t.students.forEach((r,a)=>{let o=r.id,s=r.scores||[];s.length>0?s.forEach((c,l)=>{e.push({...i,uniqueId:`class_${n}_student_${o}_score_${c.id}`,studentId:o,studentName:r.name,gender:r.gender===`male`?`ç”·`:`å¥³`,age:r.age,scoreId:c.id,examDate:c.createDate,score:c.score,_meta:{classId:n,studentId:o,isFirstStudent:a===0&&l===0,studentCount:t.students.length,hasScores:!0,scoreCount:s.length,isFirstScore:l===0}})}):e.push({...i,uniqueId:`class_${n}_student_${o}_empty`,studentId:o,studentName:r.name,gender:r.gender===`male`?`ç”·`:`å¥³`,age:r.age,scoreId:`--`,examDate:`--`,score:`--`,_meta:{classId:n,studentId:o,isFirstStudent:a===0,studentCount:t.students.length,hasScores:!1,scoreCount:0}})})}),e}),J=e=>e.includes(`é«˜ä¸€`)?`é«˜ä¸€`:e.includes(`é«˜äºŒ`)?`é«˜äºŒ`:e.includes(`é«˜ä¸‰`)?`é«˜ä¸‰`:`æœªçŸ¥`,Y=async()=>{try{let e=await j.getClasses({page:1,size:100});e.code===200&&(k.value=e.data)}catch(e){console.error(`åŠ è½½ç­çº§åˆ—è¡¨å¤±è´¥:`,e)}},X=async()=>{C.value=!0;try{let e=await P.getNestedClasses({page:T.value,size:E.value,grade:D.value||void 0,className:O.value||void 0});e.code===200?(A.value=e.data,M.value={page:e.page||T.value,size:e.size||E.value,total:e.total||0},console.log(`åŠ è½½çš„åµŒå¥—æ•°æ®:`,A.value),console.log(`ç”Ÿæˆçš„å¹³é“ºæ•°æ®:`,q.value)):console.error(`åŠ è½½æ•°æ®å¤±è´¥:`,e.message)}catch(e){console.error(`åŠ è½½æ•°æ®å¤±è´¥:`,e)}finally{C.value=!1}},ie=({row:e,column:t,rowIndex:n,columnIndex:r})=>{let i=e._meta;return r<3?i.isFirstStudent?{rowspan:q.value.filter(e=>e._meta.classId===i.classId).length,colspan:1}:{rowspan:0,colspan:0}:r>=3&&r<=6?i.hasScores?i.isFirstScore?{rowspan:i.scoreCount,colspan:1}:{rowspan:0,colspan:0}:i.isFirstStudent?{rowspan:1,colspan:1}:{rowspan:0,colspan:0}:{rowspan:1,colspan:1}},ae=({row:e,column:t,rowIndex:n,columnIndex:r})=>({backgroundColor:`#f5f7fa`,color:`#333`,fontWeight:`600`,fontSize:`14px`,borderRight:`2px solid #dcdfe6`,borderBottom:`2px solid #c0c4cc`,padding:`12px 0`}),oe=({row:e,column:t,rowIndex:n,columnIndex:r})=>{if(t.fixed===`right`)return{backgroundColor:`#ffffff`,position:`relative`,zIndex:2,borderRight:`2px solid #dcdfe6`,borderBottom:`1px solid #e4e7ed`,borderTop:`1px solid #e4e7ed`};if(r<3&&e._meta.isFirstStudent)return{backgroundColor:`#f0f9ff`,fontWeight:`500`,borderRight:`2px solid #409EFF`,borderBottom:`2px solid #409EFF`,borderTop:`1px solid #e4e7ed`};if(r>=3&&r<=6&&(e._meta.hasScores&&e._meta.isFirstScore||!e._meta.hasScores&&e._meta.isFirstStudent))return{backgroundColor:`#f8f9fa`,borderRight:`1px solid #e4e7ed`,borderBottom:`1px solid #e4e7ed`,borderTop:`1px solid #e4e7ed`};if(r>=7&&e.score!==`--`){let t=e.score;return t>=90?{backgroundColor:`#f0f9eb`,color:`#67C23A`,fontWeight:`500`,borderRight:`2px solid #e4e7ed`,borderBottom:`1px solid #e4e7ed`,borderTop:`1px solid #e4e7ed`}:t>=80?{backgroundColor:`#ecf5ff`,color:`#409EFF`,fontWeight:`500`,borderRight:`2px solid #e4e7ed`,borderBottom:`1px solid #e4e7ed`,borderTop:`1px solid #e4e7ed`}:t>=60?{backgroundColor:`#fdf6ec`,color:`#E6A23C`,fontWeight:`500`,borderRight:`2px solid #e4e7ed`,borderBottom:`1px solid #e4e7ed`,borderTop:`1px solid #e4e7ed`}:{backgroundColor:`#fef0f0`,color:`#F56C6C`,fontWeight:`500`,borderRight:`2px solid #e4e7ed`,borderBottom:`1px solid #e4e7ed`,borderTop:`1px solid #e4e7ed`}}return{borderRight:`2px solid #e4e7ed`,borderBottom:`1px solid #e4e7ed`,borderTop:`1px solid #e4e7ed`}},se=()=>{T.value=1,O.value=``},ce=()=>{T.value=1},Z=()=>{X()},le=()=>{D.value=``,O.value=``,T.value=1,X()},ue=e=>{E.value=e,T.value=1,X()},de=e=>{T.value=e,X()},fe=e=>{switch(e){case`é«˜ä¸€`:return`success`;case`é«˜äºŒ`:return`warning`;case`é«˜ä¸‰`:return`danger`;default:return`info`}},pe=e=>{if(e===`--`||e==null)return`score-empty`;let t=Number(e);return t>=90?`score-excellent`:t>=80?`score-good`:t>=60?`score-normal`:`score-poor`},Q=e=>e>=90?`ä¼˜ç§€`:e>=80?`è‰¯å¥½`:e>=60?`åŠæ ¼`:`ä¸åŠæ ¼`,$=e=>{if(e===`--`)return`--`;try{let t=new Date(e);return`${t.getMonth()+1}æœˆ${t.getDate()}æ—¥`}catch{return e}},me=e=>{let t=A.value.find(t=>t.id===e.classId);if(!t)return;let n=t.students.length,r=0,i=0,a=0,o=100;t.students.forEach(e=>{(e.scores||[]).forEach(e=>{r+=e.score,i++,a=Math.max(a,e.score),o=Math.min(o,e.score)})});let s=i>0?(r/i).toFixed(2):`0`,c=`
ç­çº§è¯¦æƒ…ï¼š
ç­çº§åç§°ï¼š${t.name}
å¹´çº§ï¼š${e.grade}
å­¦ç”Ÿäººæ•°ï¼š${n}
æœ‰æˆç»©å­¦ç”Ÿï¼š${t.students.filter(e=>e.scores?.length>0).length}äºº
æˆç»©ç»Ÿè®¡ï¼š
  - å¹³å‡åˆ†ï¼š${s}
  - æœ€é«˜åˆ†ï¼š${a||`--`}
  - æœ€ä½åˆ†ï¼š${o||`--`}
  - æˆç»©è®°å½•æ•°ï¼š${i}
  `.trim();alert(c)},he=e=>{let t=A.value.find(t=>t.id===e.classId);if(!t)return;let n=t.students.find(t=>t.id===e.studentId);if(!n||!n.scores||n.scores.length===0){alert(`å­¦ç”Ÿ ${e.studentName} æš‚æ— æˆç»©è®°å½•`);return}let r=n.scores,i=(r.reduce((e,t)=>e+t.score,0)/r.length).toFixed(2),a=Math.max(...r.map(e=>e.score)),o=Math.min(...r.map(e=>e.score)),s=`
å­¦ç”Ÿæˆç»©è¯¦æƒ…ï¼š
å­¦ç”Ÿå§“åï¼š${n.name}
ç­çº§ï¼š${e.className}
å¹´é¾„ï¼š${n.age}
æ€§åˆ«ï¼š${e.gender}

æˆç»©è®°å½•ï¼ˆå…±${r.length}æ¬¡ï¼‰ï¼š
${r.map((e,t)=>`${t+1}. ${$(e.createDate)} - ${e.score}åˆ† (${Q(e.score)})`).join(`
`)}

å¹³å‡åˆ†ï¼š${i}
æœ€é«˜åˆ†ï¼š${a}
æœ€ä½åˆ†ï¼š${o}
  `.trim();alert(s)};return s(()=>{Y(),X()}),o([T,E,D,O],()=>{X()},{immediate:!1}),(o,s)=>{let f=c(`el-option`),h=c(`el-select`),g=c(`el-icon`),j=c(`el-button`),P=c(`el-table-column`),J=c(`el-tag`),Y=c(`el-table`),X=c(`el-pagination`),ge=n(`loading`);return t(),p(`div`,F,[y(`div`,ee,[y(`div`,te,[y(`div`,ne,[y(`div`,re,[w(h,{modelValue:D.value,"onUpdate:modelValue":s[0]||=e=>D.value=e,clearable:``,placeholder:`é€‰æ‹©å¹´çº§`,style:{width:`120px`},onChange:se},{default:_(()=>[w(f,{label:`é«˜ä¸€`,value:`é«˜ä¸€`}),w(f,{label:`é«˜äºŒ`,value:`é«˜äºŒ`}),w(f,{label:`é«˜ä¸‰`,value:`é«˜ä¸‰`})]),_:1},8,[`modelValue`])]),y(`div`,I,[w(h,{modelValue:O.value,"onUpdate:modelValue":s[1]||=e=>O.value=e,clearable:``,placeholder:`é€‰æ‹©ç­çº§`,style:{width:`150px`},onChange:ce,filterable:``},{default:_(()=>[(t(!0),p(d,null,S(k.value,e=>(t(),v(f,{key:e.id,label:e.name,value:e.name},null,8,[`label`,`value`]))),128))]),_:1},8,[`modelValue`])]),y(`div`,L,[w(j,{loading:C.value,type:`primary`,onClick:Z},{default:_(()=>[w(g,null,{default:_(()=>[w(i(u))]),_:1}),s[4]||=x(` æŸ¥è¯¢ `,-1)]),_:1},8,[`loading`]),w(j,{type:`default`,onClick:le},{default:_(()=>[...s[5]||=[x(` é‡ç½® `,-1)]]),_:1})])]),!C.value&&A.value.length>0?(t(),p(`div`,R,[y(`span`,null,`æ€»ç­çº§æ•°: `+r(M.value.total),1),y(`span`,null,`å½“å‰é¡µ: `+r(T.value)+`/`+r(N.value),1),y(`span`,null,`æ€»å­¦ç”Ÿæ•°: `+r(G.value),1),y(`span`,null,`æ€»æˆç»©è®°å½•: `+r(K.value),1)])):m(``,!0)])]),y(`div`,z,[y(`div`,B,[e((t(),v(Y,{data:q.value,"span-method":ie,"cell-style":oe,"header-cell-style":ae,border:``,height:`600px`,"row-key":`uniqueId`,stripe:``,style:{width:`100%`},class:`enhanced-table`},{default:_(()=>[w(P,{align:`center`,label:`ç­çº§ID`,prop:`classId`,width:`100`}),w(P,{label:`ç­çº§åç§°`,prop:`className`,width:`150`}),w(P,{align:`center`,label:`å¹´çº§`,prop:`grade`,width:`100`},{default:_(({row:e})=>[w(J,{type:fe(e.grade),size:`small`},{default:_(()=>[x(r(e.grade),1)]),_:2},1032,[`type`])]),_:1}),w(P,{align:`center`,label:`å­¦ç”ŸID`,prop:`studentId`,width:`100`}),w(P,{label:`å­¦ç”Ÿå§“å`,prop:`studentName`,width:`120`}),w(P,{align:`center`,label:`æ€§åˆ«`,prop:`gender`,width:`80`},{default:_(({row:e})=>[w(J,{type:e.gender===`ç”·`?`primary`:`danger`,size:`small`},{default:_(()=>[x(r(e.gender),1)]),_:2},1032,[`type`])]),_:1}),w(P,{align:`center`,label:`å¹´é¾„`,prop:`age`,width:`80`}),w(P,{align:`center`,label:`æˆç»©ID`,prop:`scoreId`,width:`100`}),w(P,{align:`center`,label:`è€ƒè¯•æ—¥æœŸ`,prop:`examDate`,width:`120`},{default:_(({row:e})=>[x(r($(e.examDate)),1)]),_:1}),w(P,{align:`center`,label:`åˆ†æ•°`,prop:`score`,width:`100`},{default:_(({row:e})=>[y(`span`,{class:a(pe(e.score))},r(e.score||`--`),3)]),_:1}),w(P,{align:`center`,label:`ç­‰çº§`,width:`100`},{default:_(({row:e})=>[e.score!==void 0&&e.score!==null&&e.score!==`--`?(t(),p(`span`,V,r(Q(e.score)),1)):(t(),p(`span`,H,`--`))]),_:1}),w(P,{align:`center`,fixed:`right`,label:`æ“ä½œ`,width:`200`},{default:_(({row:e})=>[y(`div`,U,[e._meta.isFirstStudent?(t(),v(j,{key:0,type:`primary`,link:``,size:`small`,onClick:b(t=>me(e),[`stop`])},{default:_(()=>[...s[6]||=[x(` ç­çº§è¯¦æƒ… `,-1)]]),_:1},8,[`onClick`])):m(``,!0),e.studentId&&e.studentId!==`--`?(t(),v(j,{key:1,type:`success`,link:``,size:`small`,onClick:b(t=>he(e),[`stop`])},{default:_(()=>[...s[7]||=[x(` æˆç»©è¯¦æƒ… `,-1)]]),_:1},8,[`onClick`])):m(``,!0)])]),_:1})]),_:1},8,[`data`])),[[ge,C.value]])]),y(`div`,W,[w(X,{"current-page":T.value,"onUpdate:currentPage":s[2]||=e=>T.value=e,"page-size":E.value,"onUpdate:pageSize":s[3]||=e=>E.value=e,"page-sizes":[1,5,10,20],total:M.value.total,layout:`total, sizes, prev, pager, next, jumper`,onSizeChange:ue,onCurrentChange:de,background:``,disabled:C.value},null,8,[`current-page`,`page-size`,`total`,`disabled`])])]),s[8]||=l(`<div class="documentation-section" data-v-049781ee><div class="section-header" data-v-049781ee><h3 style="text-align:left;" data-v-049781ee>æ€è·¯ä¸ä»£ç </h3></div><div class="documentation-content" data-v-049781ee><div class="doc-block" data-v-049781ee><h4 data-v-049781ee>ğŸ“Œ æ ¸å¿ƒæ€è·¯</h4><p data-v-049781ee>å±•ç¤ºåµŒå¥—æ•°æ®ï¼ˆç­çº§åŒ…å«å­¦ç”Ÿåˆ—è¡¨ï¼‰çš„è¡¨æ ¼åˆå¹¶å•å…ƒæ ¼å¤„ç†ï¼Œåˆ†é¡µåŸºäºç­çº§ï¼Œå‰ç«¯å®ç°å¹³é“ºå’Œåˆå¹¶ã€‚</p><div class="key-points" data-v-049781ee><div class="point-item" data-v-049781ee><span class="point-icon" data-v-049781ee>ğŸ”¹</span><span class="point-text" data-v-049781ee><strong data-v-049781ee>ä¿æŒåµŒå¥—ç»“æ„</strong>ï¼šåç«¯è¿”å›ç­çº§åŒ…å«å­¦ç”Ÿçš„åµŒå¥—æ•°æ® </span></div><div class="point-item" data-v-049781ee><span class="point-icon" data-v-049781ee>ğŸ”¹</span><span class="point-text" data-v-049781ee><strong data-v-049781ee>å‰ç«¯æŒ‰éœ€å¹³é“º</strong>ï¼šåªå¹³é“ºå½“å‰é¡µçš„æ•°æ®ï¼Œå‡å°‘è®¡ç®—é‡ </span></div><div class="point-item" data-v-049781ee><span class="point-icon" data-v-049781ee>ğŸ”¹</span><span class="point-text" data-v-049781ee><strong data-v-049781ee>åŠ¨æ€åˆå¹¶è®¡ç®—</strong>ï¼šæ ¹æ®æ¯ä¸ªç­çº§çš„å­¦ç”Ÿæ•°é‡è®¡ç®—åˆå¹¶è¡Œæ•° </span></div><div class="point-item" data-v-049781ee><span class="point-icon" data-v-049781ee>ğŸ”¹</span><span class="point-text" data-v-049781ee><strong data-v-049781ee>æ­£ç¡®åˆ†é¡µ</strong>ï¼šåˆ†é¡µåŸºäºç­çº§æ•°é‡ï¼Œç¡®ä¿ç­çº§æ•°æ®å®Œæ•´ </span></div></div></div><div class="doc-block" data-v-049781ee><h4 data-v-049781ee>ğŸ’» å…³é”®ä»£ç å®ç°</h4><h5 data-v-049781ee>1. æ•°æ®å¹³é“ºé€»è¾‘</h5><div class="code-block" data-v-049781ee><pre data-v-049781ee><code class="language-javascript" data-v-049781ee>
const flatData = currentPageClasses.flatMap(cls =&gt; {
  const students = studentsMap.get(cls.id) || []
  return students.length &gt; 0
    ? students.map(student =&gt; ({
        ...cls,
        ...student,
        gender: student.gender === &#39;male&#39; ? &#39;ç”·&#39; : &#39;å¥³&#39;
      }))
    : [{ ...cls, studentName: &#39;æš‚æ— å­¦ç”Ÿ&#39; }]
})</code></pre></div><h5 data-v-049781ee>2. åˆå¹¶å•å…ƒæ ¼ç®—æ³•</h5><div class="code-block" data-v-049781ee><pre data-v-049781ee><code class="language-javascript" data-v-049781ee>
const spanMethod = ({ row, column, rowIndex, columnIndex }) =&gt; {
  if (columnIndex &lt; 4) {
    if (row.isFirstStudent) {
      return {
        rowspan: spanMap.get(row.classId),
        colspan: 1
      }
    }
    return { rowspan: 0, colspan: 0 }
  }
  return { rowspan: 1, colspan: 1 }
}</code></pre></div></div><div class="doc-block" data-v-049781ee><h4 data-v-049781ee>âš ï¸ æ³¨æ„äº‹é¡¹</h4><div class="notes" data-v-049781ee><div class="note-item warning" data-v-049781ee><strong data-v-049781ee>æ€§èƒ½è€ƒè™‘ï¼š</strong>åªå¹³é“ºå½“å‰é¡µæ•°æ®ï¼Œé¿å…å¤§æ•°æ®é‡ä¸‹çš„æ€§èƒ½é—®é¢˜ </div><div class="note-item info" data-v-049781ee><strong data-v-049781ee>åˆ†é¡µé€»è¾‘ï¼š</strong>åˆ†é¡µåŸºäºç­çº§æ•°é‡ï¼Œéœ€è¦ç¡®ä¿æ¯ä¸ªç­çº§çš„æ•°æ®å®Œæ•´æ€§ </div></div></div></div></div>`,1)])}}}),[[`__scopeId`,`data-v-049781ee`]]);export{G as default};